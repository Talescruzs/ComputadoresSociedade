{% extends "base.html" %}
{% block content %}
<h2 style="margin: 0 0 12px 0;">Insights e Correlações</h2>
<p class="muted" style="color:#94a3b8">Visualize métricas agregadas e relações entre variáveis (somente leitura).</p>

<div class="grid">
  <section class="card">
    <div class="card-header">
      <h2>Lotação média por linha</h2>
    </div>
    <div class="card-body">
      <canvas id="chartLinha" height="140"></canvas>
    </div>
  </section>

  <section class="card">
    <div class="card-header">
      <h2>Lotação média por hora do dia</h2>
    </div>
    <div class="card-body">
      <canvas id="chartHora" height="140"></canvas>
    </div>
  </section>

  <section class="card">
    <div class="card-header">
      <h2>Correlação</h2>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table" data-table-sort>
          <thead>
            <tr>
              <th data-sort="string">Variáveis</th>
              <th data-sort="number">Correlação (Pearson)</th>
              <th data-sort="string">Interpretação</th>
            </tr>
          </thead>
          <tbody id="cor-table">
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <small class="muted" style="color:#94a3b8">Correlação calculada no cliente a partir dos endpoints de analytics.</small>
    </div>
  </section>

  <section class="card">
    <div class="card-header">
      <h2>Mapa de calor (Hora × Linha)</h2>
    </div>
    <div class="card-body">
      <div id="heatmap" style="overflow:auto"></div>
      <small class="muted" style="color:#94a3b8">Intensidade indica maior lotação média.</small>
    </div>
  </section>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Script da página -->
<script src="{{ url_for('static', filename='js/insights.js') }}"></script>
{% endblock %}
