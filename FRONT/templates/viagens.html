{% extends "base.html" %}
{% block content %}
<section class="bg-light p-3 p-md-4 rounded-3">
  <div class="card shadow-sm bg-white border-0">
    <div class="card-header bg-dark text-white d-flex align-items-center justify-content-between">
      <h5 style="margin:0">Detalhes das Viagens</h5>
      <div class="d-flex" style="gap:8px">
        <button id="btnRefreshViagens" class="btn btn-sm btn-light" type="button">Atualizar</button>
        <button type="button" class="btn btn-sm btn-light" onclick="history.back()">← Voltar</button>
      </div>
    </div>
    <div class="card-body">
      <div id="viagensMsg" class="mb-2 small text-muted"></div>

      <!-- Filtros -->
      <form id="filtroViagens" class="row g-3 mb-3">
        <div class="col-md-3">
          <label class="form-label mb-1" for="filtroPlaca">Placa</label>
          <select id="filtroPlaca" class="form-select">
            <option value="">(Todas)</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label mb-1" for="filtroLinha">Linha</label>
          <select id="filtroLinha" class="form-select">
            <option value="">(Todas)</option>
          </select>
        </div>
        <div class="col-md-3">
          <label class="form-label mb-1" for="filtroInicioDe">Início (de)</label>
          <input type="datetime-local" id="filtroInicioDe" class="form-control" />
        </div>
        <div class="col-md-3">
          <label class="form-label mb-1" for="filtroInicioAte">Início (até)</label>
          <input type="datetime-local" id="filtroInicioAte" class="form-control" />
        </div>
        <div class="col-12 d-flex flex-wrap align-items-center" style="gap:16px">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="filtroIncluirSemViagem" checked>
            <label class="form-check-label" for="filtroIncluirSemViagem">Incluir ônibus sem viagens</label>
          </div>
          <div class="ms-auto d-flex" style="gap:8px">
            <button type="button" id="btnAplicarFiltros" class="btn btn-sm btn-primary">Filtrar</button>
            <button type="button" id="btnLimparFiltros" class="btn btn-sm btn-secondary">Limpar</button>
          </div>
        </div>
      </form>

      <div class="table-responsive">
        <table class="table table-sm table-striped table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th data-sort-key="linha_nome" class="sortable">Linha</th>
              <th data-sort-key="onibus_placa" class="sortable">Ônibus</th>
              <th data-sort-key="data_inicio" class="sortable">Início</th>
              <th data-sort-key="total_registros" class="sortable">Registros</th>
              <th data-sort-key="pct_excesso" class="sortable">% Acima Cap.</th>
              <th data-sort-key="duracao_min" class="sortable">Duração (min)</th>
            </tr>
          </thead>
          <tbody id="tabelaViagens">
            <tr><td colspan="6" class="text-center">Carregando...</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
<script src="{{ url_for('static', filename='js/viagens.js') }}"></script>
{% endblock %}
